#include <iostream>
#include <vector>
#include <algorithm>
#include <numeric>
#include <ranges>
using namespace std;
namespace ranges = std::ranges;
namespace views = ranges::views;

class Solution {
    using ll = long long;
public:
    ll maxPower(vector<int>& stations, ll r, ll k) {
        ll n = stations.size();
        vector<ll> pref(n + 1), power(stations.begin(), stations.end());
        for (int i = 1; i <= n; ++i) {
            pref[i] = pref[i - 1] + power[i - 1];
        }
        for (int i = 0; i < n; ++i) {
            power[i] = pref[min(i + r + 1, n)] - pref[max(0ll, i - r)];
        }

        auto check = [&](ll min_power) {
            ++min_power;
            if (min_power == pref.back() + k) return true;
            vector<ll> d(n);
            ll sd = 0, need = 0;
            for (int i = 0; i < n; ++i) {
                sd += d[i];
                auto delta = min_power - power[i] - sd;
                if (delta > 0) {
                    need += delta;
                    if (need > k) return false;
                    sd += delta;
                    if (i + 2 * r + 1 < n) {
                        d[i + 2 * r + 1] -= delta;
                    }
                }
            }
            return true;
        };

        return *ranges::upper_bound(views::iota(0, pref.back() + k), int{}, [&](int, int b) {
            return !check(b);
        });

        vector<int> f(pref.back() + k + 1);
        std::iota(f.begin(), f.end(), 0);
        return std::upper_bound(f.begin(), f.end(), int{}, [&](int, int b) { return !check(b); }) - f.begin();

        ll left = -2;
        ll right = pref.back() + k;
        while (left + 1 < right) {
            ll mid = left + (right - left) / 2;
            if (check(mid))
                left = mid;
            else
                right = mid;
        }

        return left + 1;
    }
};

int s[] = {49479,83626,2520,69526,4065,508,89090,54768,49491,92167,74236,3137,90933,22599,64735,31061,7408,85268,20723,62278,38928,54445,50149,67387,7427,78595,10758,18564,60226,25221,13345,77656,34341,5392,63428,29173,78147,53029,51163,88733,77160,64775,6579,26378,78182,21647,2068,10323,79231,96179,56824,52633,9269,78130,53561,95828,74653,95258,98807,16457,52735,77252,14469,11838,33598,50966,37041,94239,79952,20148,43438,27367,40564,31622,89884,97361,79416,96498,82211,95073,40443,66577,45233,44590,25627,23102,45377,96310,38846,64843,51089,51642,26258,65298,15809,69236,63813,18944,68378,95864,61683,64895,87872,91901,71743,4162,66521,87061,37749,62074,84290,67305,44181,28940,10066,2717,41685,26023,50424,94296,34745,34510,96061,95481,65557,76319,78682,77552,17749,50997,94599,8886,15156,9054,80364,6152,8428,10500,23873,7898,56331,39627,80862,80734,24028,90764,61523,76299,33940,61282,87130,70312,85686,20051,35657,56225,95002,50103,13068,21875,43275,21478,64751,14991,88987,24207,37882,93678,81881,48179,78984,28857,59065,2986,50260,90975,2096,89669,16174,753,44179,61890,20928,26808,43268,3725,19642,40501,23701,98230,71531,77807,60492,71693,91597,63040,13555,38368,68741,28077,89306,63745,20623,11852,58198,37105,60247,15925,82467,4512,12334,22819,50176,14356,94305,9118,57965,40014,80955,24842,63917,74315,1548,92466,52181,1894,64651,28188,18678,63866,81455,92838,95108,5982,59212,32093,50463,89558,99892,94900,867,39636,94496,21226,33882,94477,43905,37894,87380,92815,50607,27962,36682,99628,75408,75661,42839,69271,93468,34860,28187,16762,39259,34754,39649,15823,57832,233,46929,72514,44533,8583,6475,96740,16612,90807,91993,42280,20783,74557,60164,42358,945,33419,54447,6195,67345,95098,42196,48622,91879,74280,36991,55091,23517,89068,29344,66736,38112,61698,97816,76822,29335,61455,69612,43279,41187,30820,20589,69401,60727,66411,45341,44183,77818,54999,48036,84974,92774,50278,54190,82379,93971,86131,46515,99299,5079,70990,28589,97673,69159,1491,80932,45341,36031,85267,8841,45049,24533,11928,95306,77259,84517,22072,13560,86854,21018,81289,45785,10390,91655,82354,26019,50026,91063,10567,30504,90950,14541,28251,39575,32363,76810,84591,11749,87795,26947,19771,90669,48512,94274,61002,61275,61177,19726,98114,9916,31374,22554,13857,43704,84371,68217,18501,81067,47278,81897,21634,48252,5935,75143,29403,59940,81374,39352,54796,46853,24425,81745,8382,85602,10579,68815,77236,13225,79649,59937,8598,31205,76064,90795,23670,59148,71803,50656,82675,58427,17508,60834,33621,53171,22155,10995,15921,72955,21967,64929,8913,12582,50255,22547,15583,98274,98235,46703,43764,40124,80793,8748,99294,35810,78413,37949,65902,31876,24173,10619,10561,41867,48562,33594,53718,33572,72233,46429,95951,95634,62931,22900,49892,60086,93667,41988,55241,22372,4336,3173,84131,74595,10264,20086,88533,98032,43733,20229,94695,33023,18234,66449,56384,34697,27350,9245,7520,63999,54133,69176,54874,46785,3543,33017,17614,83631,465,67232,70031,60420,51596,38564,47696,85990,45102,31814,29102,12573,70754,85721,10710,81665,93908,9014,88605,60857,80546,5764,16098,13493,37407,25295,39012,62644,95976,48016,79128,10792,31714,59754,88060,98126,23586,74165,11886,79630,43366,89781,63012,82952,8013,30732,9293,87201,44881,63751,76451,90835,84629,55438,13853,45294,85381,6717,9509,17324,94878,72406,26972,70965,52350,81782,97124,96247,20995,80634,89354,33279,83367,4241,25873,87264,64467,44511,40125,22340,29947,54889,2391,21728,54427,70614,12120,94346,39750,19893,370,45233,3728,47756,18437,50549,2874,71734,7966,39409,12221,680,42936,56365,52693,98132,33138,73701,53686,21673,18076,34459,6960,26004,1380,3399,3220,37787,54575,72882,1901,8125,42804,7677,61231,40205,62870,8535,91277,81209,28179,36112,59804,27124,63419,38772,35239,66641,34321,77568,11964,59058,35552,46773,13869,67804,83664,33439,42693,79371,12457,67965,38893,3644,83389,60896,68155,84846,80579,31845,79383,73756,25664,91489,47755,11591,35450,88208,92447,93720,45607,97408,57862,8935,27230,28213,53050,62646,46693,6326,46411,80141,26711,1358,83233,18220,23791,55287,1655,34185,42549,56551,36105,1459,91359,43013,61013,74006,68419,82648,58746,71412,77500,90835,63255,48948,58068,18515,60808,20773,91519,28757,90889,97215,92548,63362,17353,64033,4742,19868,72461,71575,69963,26931,47143,82718,29200,87359,22787,84890,64712,21705,33671,84047,37648,821,72816,58049,93449,42825,7032,78013,33169,44561,43313,59463,44126,28920,90535,62116,36450,3122,233,52191,27192,5585,3970,60860,64412,61918,84159,95040,5514,20003,76690,21543,83536,19381,91848,2798,84211,33700,18641,86114,87902,16766,97167,35607,60719,63142,80735,83397,31849,25385,74807,62509,24686,20741,28153,70291,1091,11430,88576,50219,3867,81081,16333,24206,16867,46973,71164,83946,93509,5847,96668,45043,66908,15056,2889,14153,21098,77103,53461,32506,80389,49491,45604,82377,85720,78189,97522,43577,80184,60688,85848,85586,84193,93234,53358,9238,94042,81677,54577,64838,96682,97195,59324,57218,232,56428,20112,47394,84481,15261,71826,42927,14082,78316,28573,71175,69509,58879,7486,5200,17480,1429,15500,43508,12747,50739,42735,96876,49881,11142,46497,28877,58022,56288,77156,13153,35966,60648,53173,57461,2707,33043,91577,57942,64155,82029,574,88572,71266,67811,18043,78179,87638,86587,33768,42860,10752,6900,75329,81727,39250,14049,49473,26004,46558,64732,39319,57966,99406,97670,9721,77891,48579,20467,35675,3692,67087,29744,83038,4223,1595,40627,14855,88795,88678,12632,99442,60106,59252,96388,20344,40236,75137,65035,87804,61420,58316,14566,59927,28843,24593,31562,99074,25184,7433,40648,95860,54208,20284,91240,60034,27252,15436,76742,6741,21497,50652,61411,9283,18843,34551,48656,96420,94379,84817,82565,91886,88708,72279,85782,80152,20608,56864,1924,4913,22481,18530,68359,81273,743,4442,45334,75240,52809,42082,84231,64933,16444,44649,56947,70507,10068,78669,73068,46702,51566,37322,74962,3391,78577,55603,88846,49668,74730,13062,91369,87694,43262,69112,63875,57830,57183,58886,30248,23521,85870,22163,41134,53484,48897,13062,13427,90545,26541,87590,54017,6434,21123,31116,6895,12224,38755,92610,61024,82635,91578,4751,20042,97109,44276,72265,53455,1599,78944,5470,39634,82458,47661,22129,31685,25263,16959,22496,8349,85505,23813,8076,93590,70264,22179,76913,86816,57848,81936,64252,64123,79226,97440,61954,94049,46817,69138,52577,16955,86726,31815,27451,8015,50333,16534,70153,26121,580,1308,18718,19659,59577,21089,24543,5740,60931,57855,24567,89835,144,44267,62790,69040,37980,43826,85223,15634,16444,45854,43738,33656,97234,65287,80595,97519,86665,41541,41899,27241,33426,48987,84799,93865,15360,34831,11428,4514,2945,16955,64720,63355,87072,54153,96728,96778,57489,16506,32376,51784,30952,37723,36008,58823,73927,91079,31557,30815,87902,75832,23438,21095,36445,54924,20519,91853,48711,47575,28088,46150,64872,24514,77653,34228,46890,36463,37669,71369,74888,98195,51992,84417,10578,40340,23719,70604,51331,74835,5796,98406,84445,83244,44988,98686,25406,79619,4686,98611,68825,68029,76100,42665,30110,46812,38145,70806,46869,60564,40643,65781,172,49283,91974,94977,60460,67147,13971,42520,71483,73536,16348,34105,83823,56129,1821,34552,46099,94510,53549,19749,96087,25609,41731,75723,78372,42492,71943,96975,86912,4106,73534,28427,23725,76624,48275,50788,11860,64583,25001,40386,86163,82032,82604,24976,98014,92775,71617,6474,17458,40492,25364,56893,52861,17137,95140,48608,88972,15781,55461,72161,73938,10963,23848,19799,19988,61434,64107,30164,24140,93706,20338,79089,2771,42265,70330,13988,65195,63223,24315,7492,2362,2434,28648,3974,3934,25339,82747,59680,65344,60815,37197,48803,68903,86958,61729,83998,68890,83872,24068,41177,48880,43512,84449,85735,20992,53126,16985,97778,20361,96895,2693,36665,11058,39394,6598,77723,12053,97966,71113,41747,66123,1113,39323,90296,48605,4680,52366,91832,55587,61716,30723,44593,95295,29866,93784,81994,30910,45062,82951,90491,53602,59401,24989,18774,62176,89074,10787,62679,11884,13818,43034,40588,52301,68632,99924,42132,54391,77759,26331,29722,25731,44193,70163,22630,78206,66920,23384,29349,90052,60649,36468,11466,23852,19384,75452,65204,57455,52477,40179,68615,1657,19268,42202,41178,88306,38910,5201,69979,8834,56116,7180,86469,9947,32737,93439,66003,14727,41531,4998,26202,22744,41115,99798,60242,16291,5080,41468,51778,42342,95416,40847,19848,2099,53224,28350,20450,76052,45223,1293,23334,47988,69817,65374,51165,58535,65478,49730,45493,69100,75320,73439,21904,2754,29878,10109,54595,78057,64708,45402,69134,84248,96451,97370,61091,46726,33560,71161,5482,63504,4807,47674,52157,34869,53369,7726,56569,41533,53796,13046,46022,26793,41787,8507,86008,59338,91217,5973,11238,42075,9646,37842,68585,58512,10572,74041,62003,97661,27943,57721,16647,92025,56126,62951,90325,20677,13633,30660,10882,96515,83951,27887,64473,82020,17170,90891,83843,47440,24349,65845,2652,1488,97010,10747,9961,48386,6089,66287,2337,46419,21749,30269,68893,95471,87897,24643,44269,18884,83892,98749,67353,65680,7988,13062,22313,55589,14961,26629,10674,46470,84093,96754,77698,22048,93222,57423,75124,96214,63925,87368,57929,51168,24752,14109,87715,94302,98476,39026,24485,18814,63619,27265,56017,44851,15406,64475,26229,81795,439,96531,49198,391,87632,36173,30721,84610,45930,87623,18855,585,79485,93446,64655,53177,1390,74525,23584,5043,46641,17023,33970,64497,50710,18821,69447,96853,96207,97942,28733,88164,42654,66125,76280,63796,62653,10306,58904,44137,40726,498,52515,87436,45994,79853,89265,16370,13918,66829,22799,2723,6100,56567,3321,18006,74639,73303,99942,2429,36393,63924,12562,82544,40313,84863,56998,24979,25589,2376,92119,34184,83042,8747,21654,73083,14578,39940,98055,97038,4975,66329,97974,93945,55345,57309,97981,41275,33134,55513,18307,79000,78350,30628,65900,6237,54833,30839,72603,60524,10729,5259,70576,88265,42763,27940,57975,21036,93039,49867,7282,96014,98975,85933,46509,4212,22924,30598,91268,77259,91500,21976,3541,55980,71070,52813,2477,67546,60629,62020,91044,78950,41274,93812,49,73176,76241,26883,15402,66172,10846,22047,97911,73343,61926,9470,54405,42318,3422,66565,90104,13827,71374,59287,26166,51013,6174,88163,91142,95837,86154,15332,48787,63153,3470,11506,81567,22988,94604,85897,59066,76356,38749,86105,20284,79194,60068,67059,31365,44252,69235,85556,63640,89330,52890,53196,40233,32020,28188,5167,7551,7844,54993,27814,73534,69477,6067,47607,18097,84170,60230,50940,88672,51025,32450,35988,90438,44110,33675,37442,28588,19609,73861,18725,98712,91700,31492,80194,71569,77146,93248,62691,68171,70566,37573,83585,98133,96356,72692,32756,82757,53126,78415,16841,32109,59708,36296,20159,52999,35400,64972,36161,67037,59159,45109,35302,43891,90033,40988,22609,38249,45811,4985,93970,40986,2742,51619,12469,95072,22222,20313,62323,88449,91804,99244,93219,2540,89250,85886,7613,10975,19190,5182,90911,842,78087,18097,3140,2346,47758,28408,8987,47854,82333,15689,82449,18119,52470,49735,92011,18767,7285,84276,15596,70986,10825,3419,37825,69105,47108,93923,63211,6035,99659,1636,30428,99268,77586,26623,19463,98862,82304,90409,18001,96977,31542,22278,47519,8634,65589,71208,60638,45884,35640,35349,59112,44448,86909,72628,34033,49442,56379,92530,18518,30373,94455,50757,96691,9595,79601,68822,75871,80116,18956,18304,76635,96740,90722,62433,66656,75163,80577,40471,18153,12689,30847,6388,53389,80500,27065,33483,26420,21892,9108,32167,85934,21536,68218,90130,2457,12129,81095,38861,62390,82042,77069,20982,64744,29051,34395,51483,38932,81275,87740,34615,73098,70410,47257,51911,77144,70868,62196,88228,42083,30859,82990,5093,84837,33883,30826,3459,57799,15876,17805,35880,66312,46495,75944,57332,56480,15066,8234,48019,13928,69168,76280,11598,5164,13117,12129,68108,93800,24168,96990,15597,98245,96162,39261,7650,12388,57515,66874,72626,67535,56312,72209,65111,45995,86959,77159,58610,35226,14820,51523,48646,65906,4216,80224,51415,12040,71035,56012,68539,61000,91201,52449,62067,9998,61147,29552,70480,5925,69438,50908,75715,47781,29535,91553,80885,46114,80002,98658,66290,50315,47558,87247,445,40552,57384,76419,94088,1680,66735,44979,23120,85758,42047,4960,15192,44585,43299,22228,38440,207,26677,78234,59724,63008,82369,18758,9732,1304,16434,11052,77027,67095,6178,21856,15452,70254,55692,88604,2222,23869,16602,50255,91007,34774,84738,82202,11937,94983,20135,35332,81520,10755,10742,83713,90501,86904,78605,99597,88451,23346,82220,76746,68300,24802,28360,73998,79474,91637,80614,66758,25938,72132,20626,13006,12603,8204,15654,29468,95031,59401,66432,77456,92640,1174,72015,14067,69764,73105,18757,78769,66890,57999,74743,99399,15145,3192,7528,49398,31414,99128,10369,90403,70805,50771,57354,93951,65028,18067,11933,55056,95232,27211,22223,82448,32822,63017,74557,1727,21093,11712,35165,73426,93076,47897,25750,70647,91137,96033,8386,46687,20238,12800,74749,82711,84856,73689,69391,43483,65478,24629,96450,2423,7362,26426,73154,43055,37649,60174,17870,60449,30412,42604,4622,73667,88669,25630,17327,1497,47409,15288,9732,91707,92323,16845,7237,37988,6004,70273,70642,95288,71719,99821,66457,486,82385,7710,86905,15369,57021,51598,55889,75596,56156,93363,69002,20768,43330,56065,17378,87034,48813,68494,16986,88962,10155,24409,52593,50392,33437,37556,61087,70372,59771,65512,77182,89250,66180,10774,70893,99025,1736,46396,9274,46887,94819,92276,30675,67150,16725,32296,86292,54024,57825,43078,18992,79137,29114,46999,18664,58803,20246,17941,40117,71418,32565,22949,60922,95863,22900,58458,87029,55454,11236,35743,9212,40789,45714,14917,16492,9170,9279,26148,98714,76151,45729,56211,67166,24677,33392,17374,49608,16043,15230,41993,51275,59345,21134,50782,79699,11269,89731,69110,56161,9151,78379,86747,14514,41431,94630,76478,77410,85453,69356,47015,52519,68318,37511,48946,63005,43656,94176,48935,59301,60827,46218,94710,7709,19887,79587,77795,3154,42878,8346,43592,98841,28163,74741,89414,45393,44641,17181,2761,41331,90350,53553,43232,20764,28113,67425,57509,85652,5072,63439,11739,11881,91550,61004,46171,81606,40171,75274,76670,15531,68850,7721,38630,39362,6341,82589,78346,51963,77591,12077,5406,48824,1813,75875,75577,48054,76671,86072,84801,15527,51846,72683,90705,71867,70572,29490,27748,59308,8611,9513,99367,11333,45231,26982,94780,20688,78713,35732,81915,85163,71856,69301,86811,56582,86159,52391,64139,26294,17000,50031,4904,96783,21088,87697,70182,7952,16605,10713,18378,78908,17168,98323,79644,66830,8006,64651,5012,72484,62082,64366,89426,15572,55674,81709,28912,17240,53458,49948,53641,49194,37147,78816,65963,77260,78022,66566,93807,40705,6822,91882,64319,14143,60245,31490,72660,69518,86132,6865,35514,30515,31778,73591,24608,77338,1705,83499,95437,16717,80558,74064,74254,56224,70988,88031,89541,10514,61875,5982,96697,68153,64736,42024,6299,73177,90577,64733,19884,3089,32277,47293,30873,19063,51586,78938,33310,65826,35780,71161,36524,80838,18230,74273,6734,92137,91596,4211,55469,84462,59233,80679,68650,8665,45405,35339,78841,2283,47266,69848,51828,79979,53028,83967,15080,73503,26130,34688,31973,77333,31759,99036,81182,90969,81610,66009,5746,87578,53282,73624,21881,71334,17768,90871,65247,28884,24305,70484,3269,21351,65853,54395,87006,25455,98375,72497,93903,99626,29361,15482,903,17344,86578,23956,19075,70148,65883,65217,67694,71167,10316,49523,45864,36305,15882,57199,73327,50825,72127,18508,76881,55143,29591,15142,40755,68838,43407,37347,7026,50901,93675,88043,29012,50004,28381,52142,97074,48452,51354,49931,66408,28565,34508,29004,85353,91908,92622,40497,65412,54208,91373,57031,15185,63216,45392,96025,84718,22710,63996,57196,80739,46187,12431,64684,34848,80465,2804,65306,46143,80778,29404,27980,75511,16513,72061,51962,27716,31290,95834,92089,46932,51107,52487,99512,62930,54724,46531,28186,23757,32275,71466,68071,3433,14890,23471,36538,42871,38225,60341,99741,57242,80630,6914,87624,11674,43637,41844,16644,31756,7925,28518,68117,19239,22157,61695,17604,50194,12165,98716,87604,97160,31780,59445,77329,9947,25275,71458,11600,89554,26036,38401,24309,94627,90299,99013,31836,23749,62961,90527,32935,82554,33017,14970,8479,51992,65911,34297,30738,67930,21320,78003,93030,22586,89223,30553,25126,4215,91693,27396,15360,27844,65473,89380,63495,35487,5614,82407,27199,85090,63781,25306,25855,1261,5504,23504,33002,64866,44748,93648,9850,24284,17456,54795,84597,22462,34481,78956,57623,92184,60840,47290,77836,82635,57673,30091,99960,94583,51500,72423,91097,60916,62005,50416,57880,60226,39494,52156,38813,88169,15651,57127,97353,38216,74280,48484,27783,42055,79491,57122,85074,54166,29989,28498,55839,60217,8107,69084,48710,61722,49203,45151,77829,51309,89805,75186,77624,47192,83335,72092,5927,13650,33913,45717,96696,98564,48353,19395,57067,41029,61785,23132,43843,79927,77592,70228,95511,23141,75594,27837,93020,52694,82981,3086,979,62748,86081,21535,61948,89268,11186,51418,41575,33148,4496,2170,35346,56158,86913,96091,2923,21934,81651,99486,13922,16362,52327,75962,15893,86567,56887,78971,41113,9670,89859,41779,83527,67956,91485,50903,8660,95038,51184,64532,30335,62134,28640,7536,19814,29262,81477,4665,3780,43252,3724,15048,89440,33129,30052,81730,43727,18201,66858,50834,37404,61338,70241,57454,78680,47757,28758,39929,95194,88248,10665,36305,24186,83908,96387,51025,45230,62483,27576,43219,96669,10544,11415,26136,39997,29354,7587,2285,5392,3283,26633,78451,30496,16483,94829,72444,87395,11061,92918,54363,70044,95768,52034,17117,61483,19367,72018,93069,10980,77682,33918,59699,70226,23687,34081,68909,89010,77767,59003,71367,37668,91299,35309,2722,72715,1670,29828,36227,93040,80222,14085,77237,19031,62203,26900,24566,4174,97694,59723,32685,6474,23354,64108,39918,92903,13614,54714,80206,64243,74363,3408,71336,26526,30475,13652,47458,18647,4014,9701,86686,34556,797,12579,95942,88776,54830,82278,37766,52774,7042,32545,22090,97293,20638,13482,814,37841,28348,20295,9488,11200,95144,81012,39507,78130,63052,26867,23419,61347,2485,18773,97355,90356,31345,94396,22996,55851,73706,34311,79975,52092,41249,27529,52084,33104,98091,4682,7580,29597,88563,54677,94191,94347,51079,85476,49864,55044,79775,48679,6359,37323,24880,28934,45414,27092,27460,56793,28199,9495,21622,98763,3075,8435,46675,21207,37857,55395,29852,98919,34717,13289,42946,59040,11025,11801,25041,29830,79539,52037,91913,83186,78012,66228,84600,50817,27133,94499,32569,39483,15277,68439,87692,43334,59728,50204,95013,56423,20056,30619,2768,82535,10948,30399,7984,74448,21209,45723,47871,97938,98320,93296,94320,93661,12768,44203,88172,40481,78899,77995,964,66694,99450,20136,59739,89258,12691,9829,25461,54937,2830,63143,91340,13637,90435,72787,37454,83292,22071,8963,2367,51407,3387,95282,45431,44012,94105,81969,39462,91952,21094,51043,29581,85611,79503,62542,37549,42811,26939,1343,94163,42287,69741,298,67479,96854,58418,30677,70787,60514,33516,82168,65680,94517,71773,45744,32473,18337,31401,88459,24192,16270,81557,15268,60866,5185,28698,16315,61129,426,79482,82023,62846,83554,25292,83192,67670,43461,71603,36271,78184,95435,66377,26278,8597,11903,75525,50776,64201,25407,91878,55497,98201,692,56100,19951,71562,6942,85211,22675,62039,55601,99141,13368,2592,77738,78667,85940,54284,97369,46835,97146,93586,72443,75577,94635,40522,92687,80612,44937,93712,93354,63525,96813,28164,12357,50295,40367,7652,22599,50348,18511,18087,28601,69242,43237,35211,38757,22393,28992,62217,62067,65429,27062,75869,51452,24106,41538,16229,90599,21796,32376,8554,8021,34016,34274,99219,85561,81503,64431,21830,59758,23710,74821,95391,43943,64492,93967,98178,99455,14950,15257,69146,70327,99983,21038,19453,36042,12310,4666,49212,23692,26353,39401,70213,39428,43966,32966,65803,56267,30814,44774,57995,28426,79767,88913,23912,17963,48063,10382,66096,43148,28492,60594,43563,67233,17016,93204,94937,6699,98590,21401,39333,7272,30562,59290,17214,53772,5593,74200,23438,46321,71682,61543,20694,96056,73341,33500,55053,23523,47654,8510,29150,38477,56485,42153,64657,58828,98018,42391,79666,49997,1459,73553,1184,35677,71404,94494,82245,10427,85503,32282,30201,85843,77848,56899,552,26251,74811,2341,56589,2534,51009,25421,94893,27467,29346,91637,26717,16362,28891,28196,16284,51559,44013,90178,25682,89801,25112,46408,6803,75051,38459,44177,31781,3290,16874,32161,76029,93028,55280,96455,53408,75973,69812,64027,61272,20520,28132,2620,53258,61470,89438,52111,18202,20967,84551,78659,83736,89334,78617,70242,23908,16309,58895,31418,14432,17805,16801,57590,55685,44646,17166,61386,34145,36789,85880,24080,72616,98245,5730,871,7480,3810,64719,12985,12144,22509,15646,25508,86794,46119,20382,32141,16776,37980,19355,84833,33647,10117,43595,48685,14404,78603,8301,19946,52404,24089,1943,59989,77223,10007,41634,28941,79910,97808,66294,42068,84310,89043,44935,18607,44811,76675,55199,66594,10528,49375,40799,71074,53486,78067,20409,95071,42901,49622,25403,53406,45209,56828,65019,66491,89585,21166,36661,15033,21458,52719,8326,27935,97411,33048,81145,50264,29552,21825,38005,78087,78950,56172,73370,1895,44773,21525,52689,49495,74847,27848,42862,27763,40549,34680,37563,45839,92517,16851,21600,50350,42656,99983,98961,68702,26755,67291,90895,26418,7958,46510,38289,43796,81602,38495,42833,67913,93526,11561,92596,37802,14624,72965,88424,26696,57236,15830,2741,44828,5686,52937,8103,70138,73727,84598,64270,46823,15302,65475,74241,83467,38327,943,69314,92791,53252,3051,48591,5974,16032,4706,77414,46566,67628,62051,63475,7410,65645,15795,40920,22168,56411,18008,27906,45209,46713,6093,53988,15523,27263,6380,29703,44425,34147,83690,20412,78594,31263,38498,42142,86960,32139,4599,66078,75723,50697,11526,64689,87367,58097,86781,35796,73294,36557,49459,28886,15143,68697,23893,45092,73272,75040,15192,91960,25283,18082,19191,87662,35716,89980,31956,70871,66042,22986,68229,15291,31478,38427,62818,45455,32401,35559,84183,37153,1247,79976,4019,29448,55509,48534,83924,73634,12899,32801,29902,64478,97323,33329,62114,83235,39649,73734,34247,58156,61461,80961,49789,5126,79948,64674,97595,34184,29321,56630,3166,81010,23692,73869,73583,29574,60809,72374,62342,43483,24810,87959,91812,62842,37768,8765,1871,75691,46075,83163,18980,7126,99334,54076,3738,4454,33355,2416,49271,95112,40385,28473,29183,7780,95967,36318,66627,69066,82631,79244,6424,58456,20422,95118,11407,51959,15554,24318,45443,95446,56382,71272,64605,24825,45656,42698,86379,17892,48762,68655,93555,17556,60818,98220,33055,75874,32706,52246,20013,56973,52193,99053,72159,68173,26661,18130,11406,4503,70886,74993,50609,5885,13685,20930,59020,22389,75641,89371,44674,22489,6244,55431,12600,4127,64702,52851,97847,10351,69903,29698,89649,36243,36896,39308,68989,77650,48863,19286,55515,32706,55362,58960,69793,73806,47028,56386,20879,47687,72344,10378,4693,4861,93390,94684,18311,48982,69988,97780,47742,42991,71897,38608,8192,4597,58090,99286,86315,41775,91450,46089,56982,92639,7894,7476,67925,38304,98715,31254,88894,21221,66459,54812,76559,94410,76191,2534,58680,33709,33276,37879,84220,67727,51686,49256,61264,8554,79896,76705,3049,38214,22771,14285,82968,44750,76060,93455,2302,9803,30960,39432,48949,36985,31382,41664,83001,82773,75052,95305,1242,48788,99634,73950,24199,75807,65048,98117,25010,19715,5185,53840,28800,39953,98642,19332,11235,5954,80808,70665,3061,2348,65690,92158,78841,54355,7307,68614,17644,52698,55877,161,79534,8251,70898,21344,90473,40856,31049,99299,75960,9114,26169,70701,78978,91517,7975,15631,95268,52666,36946,82951,93227,20651,28531,9418,47436,54839,90083,48085,61960,43054,89117,99310,99590,92951,32124,73719,32703,23452,31325,66733,26668,73567,30442,57752,94737,32520,47801,94660,14449,16983,37295,90660,90791,54362,68467,88903,34245,92586,90252,64761,12747,93994,68412,85567,38724,80394,11457,17788,3243,95591,36223,2483,67979,11822,61267,86946,99509,99755,26091,25890,44708,89651,75313,50633,84452,61757,60286,47355,32179,68419,7494,14726,27969,76874,90286,38128,50776,50856,70959,24278,61986,18535,70227,99057,30389,53325,43078,31321,35981,15672,31138,31972,88748,30375,96498,92581,61508,83332,60374,83892,97655,10940,74735,36467,97972,33714,94046,39017,10037,23652,33416,10382,89275,12426,24545,68976,76483,33996,13398,40482,64187,14167,15255,63453,25306,81320,36057,61665,90068,93565,21338,54520,95081,33725,1815,5937,82464,63617,8437,87125,64163,31063,24626,36504,66709,63326,47120,5175,40010,41918,61305,27283,92040,8864,27689,27682,88569,75287,86032,17094,57737,13873,2290,80834,10912,59487,39497,90413,73582,40529,71239,85710,71953,41726,74013,90727,48795,87667,77495,27959,89246,65770,48572,8353,71664,23150,49062,46151,15259,9796,57337,9557,28795,61191,94068,23423,12570,75926,72356,66371,57446,39930,29236,53944,27443,58926,77542,31689,42973,31171,16066,65669,5031,46526,87368,95865,64040,34446,11273,2649,91621,7642,30336,24565,95810,95703,47202,21993,45580,44489,95186,24401,34530,18383,7606,33220,65927,62270,12594,62310,29016,68905,11663,77530,72590,56668,43378,29439,3981,92026,68870,99498,53950,64318,69615,35093,33726,42834,87495,47467,15359,74402,72663,25763,46246,24263,86487,67297,28833,73029,10844,20320,49069,52202,43525,44597,94383,37087,40631,94711,55110,14311,49293,66192,68064,63719,79601,3732,19433,71537,22036,14428,12916,31337,13806,69449,75120,77516,45576,73672,19661,92129,10888,88798,57797,47864,14169,14522,1031,26805,73302,83291,13914,2108,58197,52494,16283,60664,56389,43722,94353,89909,59175,75154,1962,54326,14598,12506,82187,70250,95877,88148,25841,60175,49144,77913,24544,20348,45453,51161,8190,90452,55970,84416,60247,49298,89927,32676,99055,68285,28285,32590,12396,63901,98250,78595,76702,46261,85502,85255,93065,71664,86339,78766,29890,47819,45472,81925,6375,60069,30626,87286,4371,27639,29946,60394,91945,18875,63155,85137,45677,52783,34157,3999,72188,795,34575,88769,59572,14852,66680,59551,42573,14654,70201,80270,49794,24887,98188,55122,12297,152,24858,45333,81518,11619,31113,29082,32307,33155,2684,16067,73708,66283,63172,8313,9599,50670,43378,25001,82401,10949,36869,56219,11924,15461,40258,61329,78570,47771,54418,74534,52287,5425,17369,42353,67114,18333,88833,67749,44912,53832,23173,68655,32472,82495,9557,32277,96689,54081,77082,15002,71563,31352,7349,20386,62984,82105,22822,44085,83134,75999,39873,838,52175,12309,28997,96906,12934,82537,93393,32535,5355,7544,84856,67662,96593,20696,86884,92364,33464,83456,82625,88671,73307,33362,72232,39834,76542,11238,41758,11512,91564,99621,57833,51858,51188,54422,68655,24555,51135,9323,74593,71363,88176,81181,31600,7391,40602,5062,44309,49638,58960,36589,31713,16736,28704,91363,14227,69165,18419,11444,50796,24913,58079,32660,71450,11356,34938,58519,90061,52422,77732,83581,61413,51339,83731,17773,21310,88237,89928,76637,55140,78059,54326,17583,89273,20360,81493,64047,22582,30363,7963,93127,19862,13053,71062,22212,97398,20201,88462,93402,18694,5114,35611,16197,19318,36080,64875,47608,93288,60884,27669,32470,71766,48155,91991,18489,15293,74087,93281,32098,80874,1166,73948,25703,14642,96181,18227,11370,39990,12805,35627,65865,26886,80872,97343,33779,21156,18165,72095,44189,95753,85203,99640,52362,53515,12781,8909,91386,3810,78890,41686,6818,26668,16107,19386,10923,14139,31364,82179,62058,50950,67555,83320,86411,29332,32645,64060,54166,25715,95193,5193,19282,55688,12430,40989,17324,19613,80682,15683,49182,28811,99788,87686,80348,75283,36960,30466,98764,13653,79284,47207,43061,60022,98107,38386,33571,86463,68383,62161,38841,90454,91390,42026,82728,88683,40062,43800,99083,64339,3247,36243,68159,94887,44696,89788,12412,44169,31136,60107,39437,2720,35707,62989,2247,18874,59391,79433,6726,46282,76342,14540,85360,43387,89199,2208,38745,89864,23942,34288,71992,79672,86589,49665,22585,52154,55815,56740,79453,37025,96210,49157,99695,93247,97930,66660,59742,24217,21573,890,15244,13581,67632,7923,86103,20409,33066,74737,13240,94692,64205,73159,91539,95161,5838,97614,53992,1867,71266,55926,19816,71526,17018,40423,41772,82684,31256,32386,53728,55416,29760,47642,47167,86363,72758,20193,72073,95761,71028,87130,96197,43489,24105,2646,63204,93171,20320,91471,22713,52245,72961,688,94648,77758,523,31088,8426,93471,80089,80451,58736,24960,79922,88370,73790,17382,31855,19979,71481,29619,55565,76760,23339,4,16324,16065,44057,32746,30816,25753,22713,4840,80055,89399,6710,46765,99979,9635,12769,48784,88521,38532,45848,11197,9878,27499,61434,28937,15964,25416,22748,86057,32671,47625,19741,54380,69226,26299,72667,71711,14933,6147,29948,23374,62770,76502,27518,13355,11705,24524,26037,55158,9734,81410,72855,81643,29440,51683,5264,34029,46905,91133,66724,80411,27395,28540,42131,27804,83239,31042,45946,74026,84163,77712,18394,12896,96097,37592,36113,75980,58753,78809,81266,18591,1881,42535,20463,27863,80676,40778,49831,61045,99525,44716,68631,58339,72049,33428,11373,28639,4112,75351,72012,56304,61626,88538,35591,35446,18581,62190,33185,63869,67474,68079,65242,28986,63875,92510,3989,44619,734,97918,9801,52325,75137,96132,18512,10112,93252,88876,94564,78734,58102,46718,43241,68546,68629,25404,63311,4841,69294,18130,64822,95284,74153,55717,75041,49362,45,72818,39722,61537,86290,11984,68855,70077,7142,29427,65432,76009,85063,94288,46713,56489,34120,78507,35028,84699,86527,58668,72773,51660,88196,5939,64104,85168,68324,9019,64917,23585,54313,72810,21806,34721,49830,56872,62005,52714,76474,65433,33875,51089,25346,66826,6237,13425,17873,8197,63330,46977,50502,49180,26891,76636,26620,69200,14695,36568,6694,81003,96961,17849,60520,1491,87362,45571,23384,76359,92637,28316,2736,8850,41380,34976,81246,64141,31448,74402,71520,62834,47804,43154,58240,86893,32634,61006,21732,45413,39691,32203,12844,3155,48487,69927,497,45474,42251,48837,24476,77660,97402,21911,90947,48076,14893,7913,7887,91606,23943,67272,7398,88887,19153,57107,94665,36985,72201,6741,25812,66871,11808,68169,47124,42694,59810,38353,55303,78434,64559,4390,52096,43811,28766,85847,83538,95884,24026,85997,73159,1919,76917,64701,8659};
int r = 2353, k = 17573999;

int main()
{
    // int s[] = {1,2,4,5,0}, r = 1, k = 2;
    // int stations[] = {4,4,4,4}, r = 0, k = 3;
    // int stations[] = {1}, r = 0, k = 0;
 
    vector v(s, s + sizeof(s) / sizeof(s[0]));
    std::cout << Solution().maxPower(v, r, k) << std::endl;
    return 0;
}
